# Backup ConductR Cluster

To backup a ConductR cluster use the backup command. The backup command can be used to backup an entire cluster or individual bundles.

## Backing up an entire cluster

The backup includes all the bundles along with their configuration. The backup also includes member and agent configurations.

The following command enables the backup of an entire cluster. The output flag (`-output/-o`) can be used to specify the path to the backup.

```bash
conduct backup -o backup.zip
```

The output from the `backup` command can also be redirected to stdout.
```bash
conduct backup > backup.zip
```

## Backing up a bundle

The backup command can also be used to backup a single bundle.

```bash
conduct backup visualizer > backup.zip
```

The backup command can take the bundle name or bundle id as input. Both long and short bundle ids are supported.
If there is ambiguity in bundle name/id, it will result in error similar to other conduct cli commands.

# Restore ConductR Cluster

The restore command can take the output generated by the backup command and restore it to a `ConductR` cluster.

## Restoring from backup

```bash
conduct restore backup.zip
```

Once the backup is completed, it can be optionally combined with the restore command.

```bash
conduct backup | conduct restore -backup -
```

The `-` indicates that restore will be performed from stdout. An example is shown below.

```bash
$ conduct backup | conduct restore -backup -
Restoring bundle : continuous-delivery.
[##################################################] 100%
Loaded continuous-delivery with bundleId : 8972ab23bdbc6dddcb7b4d001c9a58fc
Bundle 8972ab23bdbc6dddcb7b4d001c9a58fc expected scale 1 is met
Scaled 8972ab23bdbc6dddcb7b4d001c9a58fc to : 1.
Restoring bundle : eslite.
[##################################################] 100%
Loaded eslite with bundleId : bfd8fbcec9570780150d701605dc8b00
Bundle bfd8fbcec9570780150d701605dc8b00 expected scale 1 is met
Scaled bfd8fbcec9570780150d701605dc8b00 to : 1.
```

### Notes on Restore
* The restore process will make a best-effort to load and then scale the bundles to appropriately.
* The scale is picked up from the `bundles.json` which is part of the backup.
* The destination cluster for restore should have the appropriate resources for the bundles to scale.
* Errors during scaling can be investigated using `conduct events` and `conduct log` commands.
* If the backup and restore clusters are different then the `host` flag can be used in the commands to specify the cluster.
